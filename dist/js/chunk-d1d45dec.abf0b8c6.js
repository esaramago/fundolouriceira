(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d1d45dec"],{1276:function(t,e,a){"use strict";var s=a("d784"),r=a("44e7"),i=a("825a"),n=a("1d80"),o=a("4840"),l=a("8aa5"),c=a("50c4"),d=a("14c3"),u=a("9263"),h=a("d039"),f=[].push,p=Math.min,v=4294967295,g=!h((function(){return!RegExp(v,"y")}));s("split",2,(function(t,e,a){var s;return s="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,a){var s=String(n(this)),i=void 0===a?v:a>>>0;if(0===i)return[];if(void 0===t)return[s];if(!r(t))return e.call(s,t,i);var o,l,c,d=[],h=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,g=new RegExp(t.source,h+"g");while(o=u.call(g,s)){if(l=g.lastIndex,l>p&&(d.push(s.slice(p,o.index)),o.length>1&&o.index<s.length&&f.apply(d,o.slice(1)),c=o[0].length,p=l,d.length>=i))break;g.lastIndex===o.index&&g.lastIndex++}return p===s.length?!c&&g.test("")||d.push(""):d.push(s.slice(p)),d.length>i?d.slice(0,i):d}:"0".split(void 0,0).length?function(t,a){return void 0===t&&0===a?[]:e.call(this,t,a)}:e,[function(e,a){var r=n(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,r,a):s.call(String(r),e,a)},function(t,r){var n=a(s,t,this,r,s!==e);if(n.done)return n.value;var u=i(t),h=String(this),f=o(u,RegExp),m=u.unicode,y=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(g?"y":"g"),b=new f(g?u:"^(?:"+u.source+")",y),_=void 0===r?v:r>>>0;if(0===_)return[];if(0===h.length)return null===d(b,h)?[h]:[];var D=0,E=0,S=[];while(E<h.length){b.lastIndex=g?E:0;var C,x=d(b,g?h:h.slice(E));if(null===x||(C=p(c(b.lastIndex+(g?0:E)),h.length))===D)E=l(h,E,m);else{if(S.push(h.slice(D,E)),S.length===_)return S;for(var w=1;w<=x.length-1;w++)if(S.push(x[w]),S.length===_)return S;E=D=C}}return S.push(h.slice(D)),S}]}),!g)},"13d5":function(t,e,a){"use strict";var s=a("23e7"),r=a("d58f").left,i=a("a640"),n=a("ae40"),o=a("2d00"),l=a("605d"),c=i("reduce"),d=n("reduce",{1:0}),u=!l&&o>79&&o<83;s({target:"Array",proto:!0,forced:!c||!d||u},{reduce:function(t){return r(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"159b":function(t,e,a){var s=a("da84"),r=a("fdbc"),i=a("17c2"),n=a("9112");for(var o in r){var l=s[o],c=l&&l.prototype;if(c&&c.forEach!==i)try{n(c,"forEach",i)}catch(d){c.forEach=i}}},"17c2":function(t,e,a){"use strict";var s=a("b727").forEach,r=a("a640"),i=a("ae40"),n=r("forEach"),o=i("forEach");t.exports=n&&o?[].forEach:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}},"29d8":function(t,e,a){},"2b94":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"o-content"},[a("div",{staticClass:"o-stack"},[a("h2",{staticClass:"a-title"},[t._v("Histórico")]),a("div",{class:{"is-loading":t.isLoading}},[a("table",{staticClass:"c-table"},[t._m(0),a("tbody",[t.stays.length?t._l(t.stays,(function(e,s){return a("tr",{key:e[".key"]},[a("td",[t._v(t._s(e.startDateStr)+" "),a("span",{staticClass:"is-hidden--small"},[t._v("até "+t._s(e.endDateStr))])]),a("td",{staticClass:"u-text-center"},[t._v(t._s(e.nights))]),a("td",[t._v(t._s(e.responsible.name)+" "),e.hosts>1?[t._v("+ "+t._s(e.hosts-1))]:t._e()],2),a("td",{staticClass:"u-text-right"},[t._v(t._s(e.total)+" €")]),a("td",{staticClass:"c-table__col-auto"},[a("button",{staticClass:"a-icon",attrs:{type:"button"},on:{click:function(a){return t.openEditModal(e)}}},[a("svg",[a("use",{attrs:{"xlink:href":"/img/sprite.svg#create"}})])])]),a("td",{staticClass:"c-table__col-auto"},[a("button",{staticClass:"a-icon",attrs:{type:"button"},on:{click:function(a){return t.deleteStay(e,s)}}},[a("svg",[a("use",{attrs:{"xlink:href":"/img/sprite.svg#delete"}})])])])])})):a("tr",[a("td",{attrs:{colspan:"6"}},[t._v("Não há registo de estadias.")])])],2),a("tfoot",[a("tr",[a("td"),a("td",{staticClass:"u-text-center"},[t._v(t._s(t.totals.nights))]),a("td"),a("td",{staticClass:"u-text-right"},[t._v(t._s(t.totals.value)+" €")]),a("td",{attrs:{colspan:"2"}})])])])])])]),a("Dialog",{attrs:{isopen:t.isEditing},on:{"close-dialog":t.closeEditModal}},[a("div",{staticClass:"o-stack"},[a("h2",{staticClass:"a-title"},[t._v("Alterar estadia")]),a("StayForm",t._g({attrs:{stay:t.editingStay},on:{"stay-updated":t.onSaveStay}},t.$listeners))],1)])],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"u-text-left"},[t._v("Data")]),a("th",[t._v("Noites")]),a("th",{staticClass:"u-text-left"},[t._v("Hóspedes")]),a("th",{staticClass:"u-text-right"},[t._v("Total")]),a("th",{attrs:{colspan:"2",width:"10"}})])])}],i=(a("4160"),a("13d5"),a("a434"),a("ac1f"),a("1276"),a("159b"),a("b38d")),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("dialog",{staticClass:"c-dialog",attrs:{open:t.isopen}},[a("div",{staticClass:"c-dialog__content"},[a("button",{staticClass:"c-dialog__close",attrs:{type:"button"},on:{click:t.close}},[a("svg",[a("use",{attrs:{"xlink:href":"/img/sprite.svg#close"}})])]),t._t("default")],2)])},o=[],l={props:["isopen"],methods:{close:function(){this.$emit("close-dialog")}}},c=l,d=(a("8e23"),a("2877")),u=Object(d["a"])(c,n,o,!1,null,null,null),h=u.exports,f=a("a4d0"),p={components:{Dialog:h,StayForm:f["a"]},data:function(){return{isLoading:null,isEditing:!1,editingStay:null,stays:[],totals:{}}},created:function(){this.getStays()},methods:{getStays:function(){var t=this;this.isLoading=!0,i["a"].collection(this.$stays).get().then((function(e){e.forEach((function(e){var a=e.data();if(a.id=e.id,a.startDate&&(a.startDateTime=new Date(a.startDate),a.startDate=a.startDateTime.toISOString().split("T")[0],a.startDateStr=a.startDateTime.toLocaleDateString("pt-PT")),a.endDate&&(a.endDateTime=new Date(a.endDate),a.endDate=a.endDateTime.toISOString().split("T")[0],a.endDateStr=a.endDateTime.toLocaleDateString("pt-PT")),a.startDate&&a.endDate){var s=864e5;a.nights=Math.round(Math.abs((a.startDateTime-a.endDateTime)/s))}var r=5;a.total=r*a.nights*a.hosts,t.stays.push(a)})),t.stays.sort((function(t,e){return e.startDateTime-t.startDateTime})),t.setTotals(),t.isLoading=!1}))},setTotals:function(){this.totals.nights=this.stays.reduce((function(t,e){return t+e.nights}),0),this.totals.value=this.stays.reduce((function(t,e){return t+e.total}),0)},deleteStay:function(t,e){var a=this,s=t.id,r=confirm("Queres mesmo apagar esta estadia?");r&&i["a"].collection(this.$stays).doc(s).delete().then((function(){a.$emit("show-toastr",{message:"Estadia removida com sucesso"}),a.stays.splice(e,1),a.$storeAudit("delete",t)})).catch((function(t){a.$emit("show-toastr",{message:"Não foi possível remover a estadia",type:"error"}),console.error(t)}))},openEditModal:function(t){this.isEditing=!0,this.editingStay=t},closeEditModal:function(){this.isEditing=!1},onSaveStay:function(){this.closeEditModal(),this.stays=[],this.isLoading=!0,this.getStays()}}},v=p,g=Object(d["a"])(v,s,r,!1,null,null,null);e["default"]=g.exports},4160:function(t,e,a){"use strict";var s=a("23e7"),r=a("17c2");s({target:"Array",proto:!0,forced:[].forEach!=r},{forEach:r})},"44e7":function(t,e,a){var s=a("861d"),r=a("c6b6"),i=a("b622"),n=i("match");t.exports=function(t){var e;return s(t)&&(void 0!==(e=t[n])?!!e:"RegExp"==r(t))}},"8e23":function(t,e,a){"use strict";a("29d8")},a434:function(t,e,a){"use strict";var s=a("23e7"),r=a("23cb"),i=a("a691"),n=a("50c4"),o=a("7b0b"),l=a("65f0"),c=a("8418"),d=a("1dde"),u=a("ae40"),h=d("splice"),f=u("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,v=Math.min,g=9007199254740991,m="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!h||!f},{splice:function(t,e){var a,s,d,u,h,f,y=o(this),b=n(y.length),_=r(t,b),D=arguments.length;if(0===D?a=s=0:1===D?(a=0,s=b-_):(a=D-2,s=v(p(i(e),0),b-_)),b+a-s>g)throw TypeError(m);for(d=l(y,s),u=0;u<s;u++)h=_+u,h in y&&c(d,u,y[h]);if(d.length=s,a<s){for(u=_;u<b-s;u++)h=u+s,f=u+a,h in y?y[f]=y[h]:delete y[f];for(u=b;u>b-s+a;u--)delete y[u-1]}else if(a>s)for(u=b-s;u>_;u--)h=u+s-1,f=u+a-1,h in y?y[f]=y[h]:delete y[f];for(u=0;u<a;u++)y[u+_]=arguments[u+2];return y.length=b-s+a,d}})},a4d0:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.stay?a("form",{staticClass:"o-stack",on:{submit:t.addStay}},[a("div",{staticClass:"c-form",class:{"--has-error":t.responsibleError}},[a("label",{attrs:{for:"responsible"}},[t._v("Hóspede responsável")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.stay.responsible,expression:"stay.responsible"}],attrs:{name:"responsible",id:"responsible"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.stay,"responsible",e.target.multiple?a:a[0])},t.removeErrorLabel]}},[a("option",{attrs:{value:"",selected:"",disabled:""}},[t._v("Seleciona")]),t._l(t.responsibles,(function(e){return a("option",{key:e[".key"],domProps:{value:e}},[t._v(t._s(e.name))])}))],2),a("p",{staticClass:"c-form__error"},[t._v(t._s(t.responsibleError))])]),a("div",{staticClass:"c-form --xs",class:{"--has-error":t.hostsError}},[a("label",{attrs:{for:"hosts"}},[t._v("Total de hóspedes")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.stay.hosts,expression:"stay.hosts"}],attrs:{type:"number",name:"hosts",id:"hosts",min:"1",max:"15",placeholder:"0"},domProps:{value:t.stay.hosts},on:{input:[function(e){e.target.composing||t.$set(t.stay,"hosts",e.target.value)},t.removeErrorLabel]}}),a("p",{staticClass:"c-form__error"},[t._v(t._s(t.hostsError))])]),a("div",[a("div",{staticClass:"o-stack --inline"},[a("div",{staticClass:"c-form",class:{"--has-error":t.startDateError||t.datesError}},[a("label",{attrs:{for:"startDate"}},[t._v("Data de chegada")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.stay.startDate,expression:"stay.startDate"}],attrs:{type:"date",name:"startDate",id:"startDate"},domProps:{value:t.stay.startDate},on:{input:[function(e){e.target.composing||t.$set(t.stay,"startDate",e.target.value)},t.onChangeDate]}}),a("p",{staticClass:"c-form__error"},[t._v(t._s(t.startDateError))])]),a("div",{staticClass:"c-form",class:{"--has-error":t.endDateError||t.datesError}},[a("label",{attrs:{for:"endDate"}},[t._v("Data de saída")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.stay.endDate,expression:"stay.endDate"}],attrs:{type:"date",name:"endDate",id:"endDate"},domProps:{value:t.stay.endDate},on:{input:[function(e){e.target.composing||t.$set(t.stay,"endDate",e.target.value)},t.onChangeDate]}}),a("p",{staticClass:"c-form__error"},[t._v(t._s(t.endDateError))])])]),t.datesError?a("p",{staticClass:"c-form__error"},[t._v("A data de chegada tem de ser anterior à data de partida.")]):t._e()]),a("div",[a("button",{staticClass:"a-button"},[t.isnew?[t._v("Adicionar")]:[t._v("Gravar")]],2)])]):t._e()},r=[],i=(a("b0c0"),a("b38d")),n={props:{isnew:Boolean,stay:{type:Object,default:function(){return{responsible:"",hosts:null,startDate:null,endDate:null}}}},data:function(){return{responsibleError:"",hostsError:"",startDateError:"",endDateError:"",datesError:!1,responsibles:[{id:0,name:"Carina"},{id:1,name:"Emanuel"},{id:2,name:"Ludmila"},{id:3,name:"Rosinha"},{id:4,name:"Rute"},{id:5,name:"Vítor"}]}},methods:{addStay:function(t){t.preventDefault();var e,a,s=!1;if(this.stay.responsible||(this.responsibleError="Seleciona o teu nome",s=!0),this.stay.hosts||(this.hostsError="Indica o número total de hóspedes",s=!0),this.stay.startDate||(this.startDateError="Indica a data de chegada",s=!0),this.stay.endDate||(this.endDateError="Indica a data de partida",s=!0),this.stay.startDate&&this.stay.endDate&&(e=new Date(this.stay.startDate).getTime(),a=new Date(this.stay.endDate).getTime(),e>=a&&(this.datesError=!0,s=!0)),!s){var r=this;r.isnew?i["a"].collection(this.$stays).add(this.stay).catch((function(t){console.error("Error writing new message to database",t)})).then((function(){r.$router.push("historico"),r.$emit("show-toastr",{message:"Estadia adicionada com sucesso"}),r.$storeAudit("add",r.stay)})).catch((function(t){r.$emit("show-toastr",{message:"Não foi possível adicionar a estadia",type:"error"}),console.error(t)})):i["a"].collection(this.$stays).doc(this.stay.id).update(this.stay).catch((function(t){console.error("Error updating message to database",t)})).then((function(){r.$emit("stay-updated"),r.$emit("show-toastr",{message:"Estadia atualizada com sucesso"}),r.$storeAudit("update",r.stay)})).catch((function(t){r.$emit("show-toastr",{message:"Não foi possível atualizar a estadia",type:"error"}),console.error(t)}))}},onChangeDate:function(t){this.datesError=!1,this.removeErrorLabel(t)},removeErrorLabel:function(t){var e=t.currentTarget.name+"Error";this[e]=""}}},o=n,l=a("2877"),c=Object(l["a"])(o,s,r,!1,null,null,null);e["a"]=c.exports},a640:function(t,e,a){"use strict";var s=a("d039");t.exports=function(t,e){var a=[][t];return!!a&&s((function(){a.call(null,e||function(){throw 1},1)}))}},ae40:function(t,e,a){var s=a("83ab"),r=a("d039"),i=a("5135"),n=Object.defineProperty,o={},l=function(t){throw t};t.exports=function(t,e){if(i(o,t))return o[t];e||(e={});var a=[][t],c=!!i(e,"ACCESSORS")&&e.ACCESSORS,d=i(e,0)?e[0]:l,u=i(e,1)?e[1]:void 0;return o[t]=!!a&&!r((function(){if(c&&!s)return!0;var t={length:-1};c?n(t,1,{enumerable:!0,get:l}):t[1]=1,a.call(t,d,u)}))}},b0c0:function(t,e,a){var s=a("83ab"),r=a("9bf2").f,i=Function.prototype,n=i.toString,o=/^\s*function ([^ (]*)/,l="name";s&&!(l in i)&&r(i,l,{configurable:!0,get:function(){try{return n.call(this).match(o)[1]}catch(t){return""}}})},b727:function(t,e,a){var s=a("0366"),r=a("44ad"),i=a("7b0b"),n=a("50c4"),o=a("65f0"),l=[].push,c=function(t){var e=1==t,a=2==t,c=3==t,d=4==t,u=6==t,h=7==t,f=5==t||u;return function(p,v,g,m){for(var y,b,_=i(p),D=r(_),E=s(v,g,3),S=n(D.length),C=0,x=m||o,w=e?x(p,S):a||h?x(p,0):void 0;S>C;C++)if((f||C in D)&&(y=D[C],b=E(y,C,_),t))if(e)w[C]=b;else if(b)switch(t){case 3:return!0;case 5:return y;case 6:return C;case 2:l.call(w,y)}else switch(t){case 4:return!1;case 7:l.call(w,y)}return u?-1:c||d?d:w}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},d58f:function(t,e,a){var s=a("1c0b"),r=a("7b0b"),i=a("44ad"),n=a("50c4"),o=function(t){return function(e,a,o,l){s(a);var c=r(e),d=i(c),u=n(c.length),h=t?u-1:0,f=t?-1:1;if(o<2)while(1){if(h in d){l=d[h],h+=f;break}if(h+=f,t?h<0:u<=h)throw TypeError("Reduce of empty array with no initial value")}for(;t?h>=0:u>h;h+=f)h in d&&(l=a(l,d[h],h,c));return l}};t.exports={left:o(!1),right:o(!0)}},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);
//# sourceMappingURL=chunk-d1d45dec.abf0b8c6.js.map